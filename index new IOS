<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<!-- Accessibility-friendly viewport; keeps safe areas, allows user zoom -->
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>PawLog ‚Äî iOS Mobile</title>

<!-- iOS PWA meta -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#4CAF50">
<!-- Prevent iOS auto-linking phone/emails/addresses -->
<meta name="format-detection" content="telephone=no, email=no, address=no">
<!-- Let Safari know we support both color schemes for form controls, etc. -->
<meta name="color-scheme" content="light dark">

<style>
/*
--- iOS visibility & readability upgrades ---
- larger default fonts via clamp()
- stronger focus-visible styles
- dynamic viewport units for keyboard-safe layouts
*/

:root{
--brand:#4CAF50;
--brand-2:#2e7d32;
--bg:#f7f8fa;
--card:#ffffff;
--text:#0c0d0e; /* slightly deeper for contrast */
--muted:#5f6773;
--line:#dfe3ea;
--chip:#e8f5e9;
--chip-2:#c8e6c9;
--danger:#ef4444;

--safe-top: env(safe-area-inset-top);
--safe-bottom: env(safe-area-inset-bottom);
--safe-left: env(safe-area-inset-left);
--safe-right: env(safe-area-inset-right);

/* type scale tuned for small screens */
--fs-11: clamp(11px, 0.7rem, 12px);
--fs-12: clamp(12px, 0.78rem, 13px);
--fs-14: clamp(14px, 0.88rem, 15px);
--fs-16: clamp(16px, 1rem, 17px);
--fs-18: clamp(18px, 1.1rem, 19px);
--radius-lg: 14px;
--radius-md: 12px;
--radius-sm: 10px;
--shadow-card: 0 1px 0 rgba(0,0,0,.04), 0 12px 24px -12px rgba(0,0,0,.18);
--blur-bg: saturate(180%) blur(8px);
}

/* Remove tap highlight, keep good font rendering */
*{
box-sizing:border-box;
-webkit-tap-highlight-color: transparent;
}

html,body{height:100%}
html{ -webkit-text-size-adjust: 100%; } /* prevent unexpected zooming/resizes */

body{
margin:0;
font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Inter, system-ui, sans-serif;
font-size: var(--fs-16);
line-height: 1.45;
background:var(--bg); color:var(--text);

/* account for sticky header & bottom bar + safe areas */
padding: calc(8px + var(--safe-top)) 10px calc(80px + var(--safe-bottom)) 10px;

/* anchor target comfort when scrolling to IDs */
scroll-padding-top: calc(56px + var(--safe-top));
}

/* Use dynamic viewport units when supported (better with iOS keyboard) */
@supports (height: 100dvh) {
body { min-height: 100dvh; }
}

header{
position: sticky; top:0; z-index:10;
padding: 10px 8px;
margin: -10px -10px 8px -10px;
padding-top: calc(10px + var(--safe-top));
background: linear-gradient(to bottom, rgba(247,248,250,0.95), rgba(247,248,250,0.6));
backdrop-filter: var(--blur-bg);
-webkit-backdrop-filter: var(--blur-bg);
border-bottom:1px solid var(--line);
display:flex; align-items:center; justify-content:space-between; gap:8px;
}
.h-title{display:flex; align-items:center; gap:8px}
.h-title h1{font-size:var(--fs-18); color:var(--brand); margin:0; letter-spacing:.01em}
.h-sub{font-size:var(--fs-12); color:var(--muted)}

.card{
background:var(--card);
border-radius:var(--radius-lg);
border:1px solid var(--line);
padding:12px;
box-shadow: var(--shadow-card);
}

.section-title{
font-weight:800; margin:2px 0 8px 2px; font-size:var(--fs-14);
letter-spacing:.01em;
}

/* Horizontal lists: make scroll nicer on iOS and keep large targets */
.activity-buttons,
.quick-row{
display:flex; gap:8px; overflow:auto; padding-bottom:6px; margin-bottom:8px;
-webkit-overflow-scrolling: touch;
scroll-snap-type: x proximity;
}
.activity-btn,
.quick-btn,
.cal-btn,
.submit-btn{
touch-action: manipulation; /* remove 300ms delay */
}
.activity-btn{
scroll-snap-align: start;
flex:0 0 auto; padding:14px 16px; border-radius:var(--radius-md);
border:2px solid var(--chip);
background:var(--chip); color:var(--brand-2); font-weight:800; font-size:var(--fs-14); cursor:pointer;
min-width: 44px; min-height: 44px; /* Apple HIG tap targets */
}
.activity-btn.selected{background:var(--chip-2); border-color:var(--brand);}

label{
font-size:var(--fs-12);
text-transform:uppercase; letter-spacing:.04em; color:var(--muted);
display:block; margin:8px 2px 4px
}

input[type="text"], input[type="number"], input[type="time"], input[type="date"], textarea, select{
width:100%; padding:14px 12px; border-radius:var(--radius-md); border:1px solid var(--line);
font-size:16px; /* keep 16px to prevent Safari zoom-in */
line-height: 1.25;
background:#fff; color:var(--text);
-webkit-appearance: none; appearance: none;
}
textarea{min-height:84px; resize:vertical;}
select{background-image:none;}

/* Strong, visible focus for accessibility */
:focus-visible{
outline: 2px solid color-mix(in srgb, var(--brand) 70%, white);
outline-offset: 2px;
border-radius: 12px;
}

.row{display:flex; gap:8px;}
.row > *{flex:1}

.chips{display:flex; flex-wrap:wrap; gap:8px; margin:6px 0 0}
.chip{
display:inline-flex; align-items:center; gap:6px; padding:10px 12px; border-radius:999px; border:1px solid var(--line); background:#f9fafb; cursor:pointer;
font-weight:800; font-size:var(--fs-14); min-height: 36px;
}
.chip[data-selected="true"]{background:var(--chip); border-color:var(--brand); color:var(--brand-2);}

.submit-btn{
width:100%; margin-top:10px; background:var(--brand); color:#fff; border:none; border-radius:var(--radius-md); padding:15px 16px;
font-weight:900; font-size:var(--fs-16); cursor:pointer;
box-shadow: 0 6px 16px rgba(76,175,80,.25);
}
.submit-btn:active{transform: translateY(1px)}

.status{min-height:22px; font-weight:800; margin-top:8px; font-size:var(--fs-14)}
.status.ok{color:#16a34a}
.status.err{color:var(--danger)}
.inline-hint{font-size:var(--fs-12); color:var(--muted)}

.quickbar{
position: fixed; left:0; right:0; bottom:0; z-index:20;
padding: 8px max(10px, var(--safe-left)) calc(8px + var(--safe-bottom)) max(10px, var(--safe-right));
background: color-mix(in srgb, #fff 98%, transparent);
backdrop-filter: blur(8px);
-webkit-backdrop-filter: blur(8px);
border-top:1px solid var(--line);
}
.quick-title{font-size:var(--fs-11); color:var(--muted); margin:0 0 6px 2px; text-transform:uppercase; letter-spacing:.04em}
.quick-row{gap:8px;}
.quick-btn{
flex:0 0 auto; border:1px solid var(--line); background:#fff; border-radius:999px; padding:10px 12px; font-weight:800; font-size:var(--fs-14);
min-height: 40px;
}

.calendar{margin-top:10px}
.calendar-head{display:flex; align-items:center; justify-content:space-between; gap:8px; margin-bottom:8px;}
.cal-nav{display:flex; gap:8px; flex-wrap:wrap}
.cal-btn{ padding:10px 12px; border:1px solid var(--line); border-radius:var(--radius-sm); background:#fff; font-weight:800; font-size:var(--fs-14); min-height:40px}

.dow-row{display:grid; grid-template-columns: repeat(7, 1fr); gap:4px; padding:0 2px}
.dow{font-size:var(--fs-11); font-weight:800; color:var(--muted); text-align:center; padding:4px 0}

.grid{display:grid; grid-template-columns: repeat(7, 1fr); gap:4px;}
.day{
background:#fff; border:1px solid var(--line); border-radius:var(--radius-sm); min-height:76px; padding:6px; display:flex; flex-direction:column; gap:4px;
}
.day.other{opacity:.5}
.day .date-num{font-weight:800; font-size:var(--fs-12)}
.pill-row{display:flex; flex-wrap:wrap; gap:4px}
.pill{ font-size:10.5px; font-weight:800; padding:3px 6px; border-radius:999px; background:var(--chip); border:1px solid var(--line); white-space:nowrap;}
.day:active{outline:2px solid var(--chip-2)}

.legend{display:flex; flex-wrap:wrap; gap:6px; font-size:var(--fs-12); margin-top:8px}
.legend .pill{background:#f9fafb}

dialog{border:none; border-radius:16px; width:100%; max-width:560px; padding:0; box-shadow:0 8px 32px rgba(0,0,0,.25)}
dialog::backdrop{background:rgba(0,0,0,.35)}
.modal-head{position:sticky; top:0; background:#fff; padding:12px; border-bottom:1px solid var(--line); display:flex; align-items:center; justify-content:space-between}
.modal-body{padding:12px; max-height:70svh; overflow:auto}
.log-item{border:1px solid var(--line); border-radius:12px; padding:10px; display:flex; align-items:center; justify-content:space-between; margin-bottom:8px}
.log-item .meta{font-size:var(--fs-12); color:var(--muted)}
.empty{color:var(--muted); font-style:italic}

.today-strip{display:flex; gap:6px; flex-wrap:wrap; margin-top:8px}
.today-chip{padding:6px 8px; border-radius:999px; background:#f9fafb; border:1px solid var(--line); font-weight:800; font-size:var(--fs-12)}

/* Dark mode polish */
@media (prefers-color-scheme: dark){
:root{
--bg:#0b0e11; --card:#0f1317; --text:#f0f2f5; --muted:#a5adba;
--line:#1f2937; --chip:#0e2011; --chip-2:#14361a;
}
.quickbar{background: rgba(16,20,24,0.85);}
header{
background: linear-gradient(to bottom, rgba(16,20,24,0.9), rgba(16,20,24,0.6));
}
.cal-btn, .quick-btn, .activity-btn, input, textarea, select, .day { background:#11161b; }
}

/* Reduce motion for sensitive users */
@media (prefers-reduced-motion: reduce){
* { animation: none !important; transition: none !important; }
.submit-btn:active{ transform: none; }
}

/* If user prefers more contrast, tighten borders and text color */
@media (prefers-contrast: more) {
:root{ --line:#bcc2cb; }
.chip, .pill, .day, .card, .quick-btn, .cal-btn, .activity-btn { border-width: 2px; }
.muted{ color: #4b525d; }
}
</style>
</head>
<body>
<!-- HEADER -->
<header>
<div class="h-title">
<div aria-hidden="true">üê∂</div>
<h1>PawLog</h1>
</div>
<div class="h-sub">Mobile ‚Ä¢ iOS</div>
</header>

<!-- MAIN -->
<main>
<!-- Quick Log -->
<section class="card" aria-labelledby="quickLogTitle">
<div id="quickLogTitle" class="section-title">Quick Log</div>

<div class="activity-buttons" id="activityButtons">
<button type="button" class="activity-btn" data-activity="Feeding" aria-pressed="false">üêæ Feeding</button>
<button type="button" class="activity-btn" data-activity="Walk" aria-pressed="false">üö∂ Walk</button>
<button type="button" class="activity-btn" data-activity="Bathroom" aria-pressed="false">üí© Bathroom</button>
<button type="button" class="activity-btn" data-activity="Medication" aria-pressed="false">üíä Medication</button>
<button type="button" class="activity-btn" data-activity="Vet Visit" aria-pressed="false">üè• Vet Visit</button>
</div>

<div class="row">
<div>
<label for="dateInput">Date</label>
<input id="dateInput" type="date" inputmode="numeric" autocomplete="off"/>
</div>
<div>
<label for="timeInput">Time</label>
<input id="timeInput" type="time" inputmode="numeric" autocomplete="off"/>
</div>
</div>

<!-- Custom fields injected here -->
<div id="dynamicFields"></div>

<label for="notesInput">Notes (optional)</label>
<textarea id="notesInput" placeholder="Any extra details..." autocapitalize="sentences"></textarea>

<button class="submit-btn" id="submitBtn">Log Activity</button>
<div class="status" id="status" role="status" aria-live="polite"></div>
<div class="inline-hint">Uses your Apps Script + local cache.</div>

<div class="section-title" style="margin-top:12px">Today</div>
<div id="todayStrip" class="today-strip"></div>
</section>

<!-- Calendar -->
<section class="calendar" aria-label="Calendar">
<div class="calendar-head">
<div class="section-title" id="monthLabel">Month</div>
<div class="cal-nav" role="group" aria-label="Calendar navigation">
<button class="cal-btn" id="syncBtn">Sync</button>
<button class="cal-btn" id="prevBtn" aria-label="Previous Month">‚óÄÔ∏é</button>
<button class="cal-btn" id="todayBtn">Today</button>
<button class="cal-btn" id="nextBtn" aria-label="Next Month">‚ñ∂Ô∏é</button>
</div>
</div>

<div class="dow-row" id="dowRow"></div>
<div class="grid" id="calendarGrid"></div>

<div class="legend" aria-label="Legend">
<span class="pill">Feeding</span>
<span class="pill">Walk</span>
<span class="pill">Bathroom</span>
<span class="pill">Medication</span>
<span class="pill">Vet Visit</span>
</div>
</section>
</main>

<!-- Sticky Quick Bar -->
<div id="quickbar" class="quickbar" style="display:none">
<div class="quick-title">Quick Add ‚Äî uses current date/time</div>
<div id="quickRow" class="quick-row"></div>
</div>

<!-- Day Modal -->
<dialog id="dayModal" aria-labelledby="dayModalTitle">
<div class="modal-head">
<div id="dayModalTitle">Logs</div>
<button class="cal-btn" id="closeModal" aria-label="Close">Close</button>
</div>
<div class="modal-body">
<div id="logsOnDay"></div>
</div>
</dialog>

<script>
// üîß Small UX helpers that don‚Äôt change your app logic:

// Toggle aria-pressed on activity buttons to improve state visibility for AT
document.getElementById('activityButtons')?.addEventListener('click', (e) => {
const btn = e.target.closest('.activity-btn');
if (!btn) return;
const pressed = btn.getAttribute('aria-pressed') === 'true';
btn.setAttribute('aria-pressed', String(!pressed));
btn.classList.toggle('selected', !pressed);
});

// Prevent layout jump when the iOS keyboard shows by ensuring scroll to focused inputs is smooth & offset by header
function scrollIntoViewIfNeeded(el){
const y = el.getBoundingClientRect().top + window.scrollY - (56 + (parseInt(getComputedStyle(document.documentElement).getPropertyValue('--safe-top'))||0));
window.scrollTo({ top: y, behavior: 'smooth' });
}
document.addEventListener('focusin', (e) => {
const el = e.target;
if (el.matches('input, textarea, select')) { scrollIntoViewIfNeeded(el); }
});

// Close dialog with ESC for convenience
(function(){
const dlg = document.getElementById('dayModal');
const close = document.getElementById('closeModal');
if (!dlg || !close) return;
close.addEventListener('click', () => dlg.close());
document.addEventListener('keydown', (e)=>{ if(e.key==='Escape' && dlg.open) dlg.close(); });
})();
</script>
</body>
</html>
